<ion-menu contentId="main-content">
  <ion-header>
    <ion-toolbar color="dark">
      <ion-title>Unitoken</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content class="ion-padding" color="dark">
    <div class="button-container">
      <ion-button
        [routerLink]="['/ajuda']"
        routerDirection="forward"
        fill="clear"
        class="base"
      >
        Ajuda
      </ion-button>
    </div>
  </ion-content>
</ion-menu>

<div class="ion-page" id="main-content">
  <ion-header>
    <ion-toolbar class="too" color="dark">
      <ion-buttons slot="start">
        <ion-menu-button></ion-menu-button>
      </ion-buttons>
      <div class="too">
        <ion-title class="escrita">Unitoken</ion-title>
        <ion-chip [routerLink]="['/user-info']" routerDirection="forward" fill="clear">
          <ion-avatar class="icon">
            <img
              alt="Silhouette of a person's head"
              src="https://ionicframework.com/docs/img/demos/avatar.svg"
            />
          </ion-avatar>
          <ion-label *ngIf="user$ | async as user">{{ user.nome }}</ion-label>
          <ion-label *ngIf="!(user$ | async)">Carregando...</ion-label>
        </ion-chip>
      </div>
    </ion-toolbar>
  </ion-header>

  <ion-content class="ion-padding" color="dark">
    <div *ngIf="totpCodes$ | async as codes; else noCodes">
      <ion-list>
        <ion-item *ngFor="let code of codes">
          <ion-label>
            <h2>{{ code.nome }}</h2>
            <p>{{ code.codigo }}</p>
            <!-- Gerando o código TOTP -->
            <p><strong>Código TOTP:</strong> {{ generateTotp(code.secret) }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </div>

    <!-- Caso não tenha códigos -->
    <ng-template #noCodes>
      <ion-text color="medium">
        <p class="ion-text-center">Sem códigos</p>
      </ion-text>
    </ng-template>

    <!-- Botões de navegação -->
    <div class="button-container">
      <ion-button fill="clear" class="conta">Trocar conta</ion-button>
      <br />
      <ion-button [routerLink]="['/login']" routerDirection="forward" fill="clear" class="conta">
        Fazer login
      </ion-button>
    </div>
  </ion-content>

  <!-- Botão flutuante para adicionar códigos -->
  <ion-fab vertical="bottom" horizontal="center" slot="fixed">
    <ion-fab-button color="primary" [routerLink]="['/codigos']" routerDirection="forward">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</div>
